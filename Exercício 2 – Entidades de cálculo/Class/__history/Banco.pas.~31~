unit Banco;

interface
uses
conexaobanco;
type
  TSQL = class
  private
  public
  procedure insertbanco(Nome, CPF: string; Salario,INSS,IR: Double);
  function Getsalario(Nome: string): Double;
  function getUltimoid: string;


  end;

implementation

{ TSQL }

function TSQL.Getsalario(Nome: string):Double;
begin
DataModule1.fdqrySQL.close;
DataModule1.fdqrySQL.sql.clear;
DataModule1.fdqrySQL.sql.add('SELECT FUM_SALARIO FROM FUNCIONARIO');
DataModule1.fdqrySQL.open;
Result:=DataModule1.fdqrySQL.FieldByName('FUM_SALARIO').value;
end;

function TSQL.getUltimoid: string;
begin
DataModule1.fdqrySQL.close;
DataModule1.fdqrySQL.sql.clear;
DataModule1.fdqrySQL.sql.add('select max(FUN_ID) as FUN_ID  from funcionario');
DataModule1.fdqrySQL.open;
Result:= DataModule1.fdqrySQL.FieldByName('FUM_ID').value;



end;

procedure TSQL.insertbanco(Nome, CPF: string; Salario,INSS,IR: Double);
var
SQL: string;
begin
//SQL := 'INSERT INTO Funcionario  (fun_id,fun_nome,fun_cpf,fum_salario,fun_inss,fun_ir)'+
//       'VALUES('+'3'+ ','+ QuotedStr( Nome) +','+CPF+','+Salario+','+INSS+','+IR+')';
//DataModule1.fdqrySQL.close;
//DataModule1.fdqrySQL.sql.clear;
//DataModule1.fdqrySQL.sql.add(SQL);
//DataModule1.fdqrySQL.ExecSQL(true);
DataModule1.fdqrySQL.sql.clear;
DataModule1.fdqrySQL.SQL.Text :=  'INSERT INTO Funcionario '+
      'VALUES( :fun_id , :fun_nome , :fun_cpf , :fum_salario , :fun_inss , :fun_ir)';
DataModule1.fdqrySQL.ParamByName('fun_id').AsInteger := 6;
DataModule1.fdqrySQL.ParamByName('fun_nome').AsString := Nome;
DataModule1.fdqrySQL.ParamByName('fun_cpf').AsString := CPF;
DataModule1.fdqrySQL.ParamByName('fum_salario').AsFloat := Salario;
DataModule1.fdqrySQL.ParamByName('fun_inss').AsFloat := INSS;
DataModule1.fdqrySQL.ParamByName('fun_ir').AsFloat := IR;
DataModule1.fdqrySQL.ExecSQL();
end;

end.
